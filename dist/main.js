(()=>{const t=document.querySelector("[data-lists]"),e=document.querySelector("[data-new-list-form]"),n=document.querySelector("[data-new-list-input]"),i=document.querySelector("[data-delete-list-button]"),a=document.querySelector("[data-list-display-container]"),d=document.querySelector("[data-list-title"),r=document.querySelector("[data-list-count"),o=document.querySelector("[data-tasks]"),s=document.getElementById("task-template"),l=document.querySelector("[data-new-task-form]"),c=document.querySelector("[data-new-task-input]"),u=document.querySelector("[data-clear-complete-tasks-button]"),m=document.querySelector("[data-close-edit-window]"),y=document.querySelector("[data-edit-submit-button]");let p="";const k="task.lists",g="task.selectedListId";let f=JSON.parse(localStorage.getItem(k))||[{id:"1",name:"Daily Chores",tasks:[]},{id:"2",name:"Grocery List",tasks:[]}],S=1e3,v=localStorage.getItem(g);function E(){b(),q()}function b(){localStorage.setItem(k,JSON.stringify(f)),localStorage.setItem(g,v)}function q(){L(t),f.forEach((e=>{const n=document.createElement("li");n.dataset.listId=e.id,n.classList.add("list-name"),n.innerText=e.name,e.id==v&&n.classList.add("active-list"),t.appendChild(n)}));const e=f.find((t=>t.id===v));null==v?a.style.display="none":(a.style.display="",d.innerText=e.name,h(e),L(o),function(t){t.tasks.forEach((t=>{const e=document.importNode(s.content,!0),n=e.querySelector("input");n.id=t.id,n.checked=t.complete;const i=e.querySelector("label");i.htmlFor=t.id,e.querySelector("[data-disclosure]").setAttribute("id",S),S++,e.querySelector("[data-task-description]").innerText="Description: "+t.content.description,e.querySelector("[data-task-priority]").innerText="Priority: "+t.content.priority,i.append(t.name),o.appendChild(e)}))}(e))}function h(t){const e=t.tasks.filter((t=>!t.complete)).length,n=1===e?"task":"tasks";r.innerText=`${e} ${n} remaining`}function L(t){for(;t.firstChild;)t.removeChild(t.firstChild)}function I(t,e,n){document.getElementById("edit-task-name").value=t,document.getElementById("edit-task-description-input").value=e,document.getElementById("edit-task-priority").value=n}t.addEventListener("click",(t=>{"li"===t.target.tagName.toLowerCase()&&(v=t.target.dataset.listId,E())})),e.addEventListener("submit",(t=>{t.preventDefault();const e=n.value;if(null==e||""===e)return;const i=(a=e,{id:Date.now().toString(),name:a,tasks:[]});var a;n.value=null,f.push(i),E()})),l.addEventListener("submit",(t=>{t.preventDefault();const e=c.value;if(null==e||""===e)return;const n=(i=e,{id:Date.now().toString(),name:i,complete:!1,content:{description:"",priority:"Low"}});var i;c.value=null,f.find((t=>t.id===v)).tasks.push(n),E()})),o.addEventListener("click",(t=>{if("input"===t.target.tagName.toLowerCase()){const e=f.find((t=>t.id===v));e.tasks.find((e=>e.id===t.target.id)).complete=t.target.checked,b(),h(e)}})),i.addEventListener("click",(t=>{f=f.filter((t=>t.id!==v)),v=null,E()})),u.addEventListener("click",(t=>{const e=f.find((t=>t.id===v));e.tasks=e.tasks.filter((t=>!t.complete)),E()})),document.addEventListener("click",(function(t){if(!t.target.hasAttribute("data-disclosure"))return;let e=document.getElementById(t.target.getAttribute("id")),n=e.querySelector("#task-content");e&&("true"==t.target.getAttribute("aria-expanded")?(t.target.setAttribute("aria-expanded",!1),n.setAttribute("hidden","")):(t.target.setAttribute("aria-expanded",!0),n.removeAttribute("hidden")))})),document.addEventListener("click",(function(t){if(!t.target.hasAttribute("data-edit-task-button"))return;let e=t.target.getAttribute("data-modal");document.getElementById(e).style.display="block";const n=f.find((t=>t.id===v)),i=t.target.closest(".task").querySelector("label");p=n.tasks.find((t=>t.id===i.htmlFor)),I(p.name,p.content.description,p.content.priority)})),m.addEventListener("click",(function(t){t.target.closest(".modal").style.display="none",I("","","")})),y.addEventListener("click",(function(t){let e=document.getElementById("edit-task-name").value,n=document.getElementById("edit-task-description-input").value,i=document.getElementById("edit-task-priority").value;p.name=e,p.content.description=n,p.content.priority=i,t.target.closest(".modal").style.display="none",I("","",""),E()})),q()})();